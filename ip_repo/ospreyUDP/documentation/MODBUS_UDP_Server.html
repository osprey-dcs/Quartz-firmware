<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>MODBUS/UDP Server</title>
  </head>
  <body>
    <h1>MODBUS/UDP Server for OspreyUDP<br>
    </h1>
    <p>This support module uses the Osprey UDP-in-fabric to allow
      applications to act as MODBUS/UDP instruments.<br>
    </p>
    <p>To use the support module in an application, include
      modbusServer.h and:<br>
    </p>
    <ul>
      <li>Provide two functions:<br>
        <span style="font-family: Courier New,Courier,monospace;">int
          modbusServerCallbackCode3(int regBase, int regCount, uint16_t
          *reg);</span><span style="font-family: Courier
          New,Courier,monospace;"><br>
        </span><span style="font-family: Courier New,Courier,monospace;">int



          modbusServerCallbackCode16(int regBase, int regCount, const
          uint16_t *reg);</span><br>
      </li>
      <li>Invoke<br>
        55<br>
        from the application initialization routine.&nbsp; The return
        value is 0 on success and -1 if the attempt to register an
        ospreyUDP endpoint fails.<br>
      </li>
    </ul>
    <p><br>
    </p>
    <h2>Functions</h2>
    <h3><span style="font-family: Helvetica,Arial,sans-serif;">int
        modbusServerUDPinit(int port);</span></h3>
    <p>Call this function to initialize and register an LWIP server on
      the specified UDP port.&nbsp; A port value less than or equal to 0
      will result in the default MODBUS port (502).<br>
    </p>
    <h3><span style="font-family: Helvetica,Arial,sans-serif;">int
        modbusServerCallbackCode3(int regBase, int regCount, uint16_t
        *reg);</span></h3>
    <p>The application provides this function to send values to the
      client in response to a function code 3 (read holding registers)
      request.&nbsp; A non-zero return value will result in a 'Modbus
      Illegal Data Address' error response to the client.<br>
    </p>
    <h3><span style="font-family: Courier New,Courier,monospace;"></span></h3>
    <p><span style="font-family: Courier New,Courier,monospace;"> </span></p>
    <h3><span style="font-family: Helvetica,Arial,sans-serif;">int
        modbusServerCallbackCode16(int regBase, int regCount, const
        uint16_t *reg);</span></h3>
    <p>The application provides this function to accept values from the
      client in response to a function code 6 (write single holding
      register) or function code 16 (write multiple holding registers)
      request.&nbsp; A non-zero return value will result in a 'Modbus
      Illegal Data Address' error response to the client.<br>
    </p>
    <h2>Diagnostic Output<br>
    </h2>
    <h3><span style="font-family: Helvetica,Arial,sans-serif;">void
        modbusServerSetDebugFunction(int (*prfunc)(const char *fmt,
        ...));<br>
      </span></h3>
    Call this function with a pointer to a printf-style function to
    enable diagnostic output.&nbsp; Call this function with a NULL
    argument to disable diagnostic output.&nbsp; For standalone Xilinx
    applications it is common to use xil_printf, for other applications
    it is common to use printf.<br>
    <br>
    <h1>License</h1>
    MIT License<br>
    <br>
    Copyright (c) 2024 Osprey DCS<br>
    <br>
    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation files
    (the "Software"), to deal in the Software without restriction,
    including without limitation the rights to use, copy, modify, merge,
    publish, distribute, sublicense, and/or sell copies of the Software,
    and to permit persons to whom the Software is furnished to do so,
    subject to the following conditions:<br>
    <br>
    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.<br>
    <br>
    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
    BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
    ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
    CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.<br>
    <br>
  </body>
</html>
